<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Search of a fusion tree under connectivity and/or size constraints."><title>Search of a fusion tree under connectivity and/or size constraints. — search_fusion_tree • c3t</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search of a fusion tree under connectivity and/or size constraints. — search_fusion_tree"><meta property="og:description" content="Search of a fusion tree under connectivity and/or size constraints."><meta property="og:image" content="dzt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">c3t</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/glossary-en.html">Glossary</a>
    <a class="dropdown-item" href="../articles/glossary-fr.html">Glossaire</a>
    <a class="dropdown-item" href="../articles/introduction-fr.html">Introduction à c3t</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atero18/c3t/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Search of a fusion tree under connectivity and/or size constraints.</h1>
      <small class="dont-index">Source: <a href="https://github.com/atero18/c3t/blob/HEAD/R/fusionTree.R" class="external-link"><code>R/fusionTree.R</code></a></small>
      <div class="d-none name"><code>search_fusion_tree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Search of a fusion tree under connectivity and/or size constraints.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">search_fusion_tree</span><span class="op">(</span></span>
<span>  distances <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contiguity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  standardQuant <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  binarQual <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  search <span class="op">=</span> <span class="st">"DFS"</span>,</span>
<span>  stopCriterion <span class="op">=</span> <span class="st">"first_valid_branch"</span>,</span>
<span>  childChoice <span class="op">=</span> <span class="st">"distance"</span>,</span>
<span>  regionalisation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linkage <span class="op">=</span> <span class="st">"complete"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">AHR_fusion_tree</span><span class="op">(</span></span>
<span>  distances <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contiguity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  standardQuant <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  binarQual <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  regionalisation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linkage <span class="op">=</span> <span class="st">"complete"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>distances</dt>
<dd><p>The distance matrix of the problem. This can be omitted
if a distance function <code>d</code> and data context <code>data</code> are provided. If only
<code>distances</code> is provided, all distances must be present. (distance matrix)</p></dd>


<dt>contiguity</dt>
<dd><p>A contiguity matrix or an <code>igraph</code> contiguity graph. If not
provided, the problem is considered completely contiguous (all elements are
neighbors of each other).</p></dd>


<dt>sizes</dt>
<dd><p>Represents the size of each element. By default, it is set
to <code>1</code> for each element (the size of a cluster becomes its cardinal).
All data must be positive or zero. (positive real numeric vector)</p></dd>


<dt>d</dt>
<dd><p>Distance function between elements. This can be omitted if
<code>distances</code> is already indicated. If present, <code>data</code> must also be
specified. Some classical distances are available, it is recommended to use
them rather than a personal function for optimisation reasons :</p><ul><li><p>"<code>euclidean</code>": Euclidean distance.</p></li>
<li><p>"<code>manhattan</code>" : Manhattan distance.</p></li>
<li><p>"<code>minkowski</code>" : Minkowski's distance. In that case a value for p &gt;= 1
must be specified.</p></li>
</ul><p>(function or string)</p></dd>


<dt>data</dt>
<dd><p>A data.frame where each row represents data related to an
element. This can be omitted if <code>d</code> is omitted. Present variables can
be quantitative or qualitative. If qualitative variables are present,
some distances may not be used. Possibility of standardising variables and
transforming qualitative variables into binary variables (one-hot encoding)
using <code>standardQuant</code> and <code>binarQual</code>. (data.frame)</p></dd>


<dt>m</dt>
<dd><p>Minimum size constraint. Must be positive or zero and small enough
for the problem to be feasible. Default is <code>0</code> (no constraint).
(positive number)</p></dd>


<dt>M</dt>
<dd><p>Maximum size constraint. Must be positive, superior or equal to <code>m</code>
and large enough for the problem to be feasible.
Default is <code>Inf</code> (no constraint). (positive number)</p></dd>


<dt>standardQuant</dt>
<dd><p><code>TRUE</code> if the variables in <code>data</code> should be
standardised (i.e., centered and scaled), <code>FALSE</code> (default) otherwise.
Standardisation is applied after the possible binarization of qualitative
variables (see <code>binarQual</code>). (flag)</p></dd>


<dt>binarQual</dt>
<dd><p><code>TRUE</code> if qualitative variables should be binarized (one-hot
encoding), for example, to make the data set compatible with common distances
or to standardize these variables. <code>FALSE</code> (default) otherwise. (flag)</p></dd>


<dt>search</dt>
<dd><p>Type of traversal to apply on the fusion tree.
Three possibilities:</p><ul><li><p>"<code>BFS</code>" (Depth First Search)</p></li>
<li><p>"<code>DFS</code>" (Breadth First Search)</p></li>
<li><p>"<code>random</code>" (random)</p></li>
</ul></dd>


<dt>stopCriterion</dt>
<dd><p>Indicates when the traversal should stop.
The possibilities are as follows:</p><ul><li><p>"<code>full</code>": The algorithm stops when all possible fusions from the initial
partition have been evaluated.</p></li>
<li><p>"<code>first_valid_node</code>": Stop when a first feasible solution is found.
Useful when a minimum size constraint is present.</p></li>
<li><p>"<code>first_valid_branch</code>": Stop as soon as a node without fusion has been
selected and a feasible solution has been found.</p></li>
</ul></dd>


<dt>childChoice</dt>
<dd><p>In the case of breadth-first or depth-first search,
the way in which child nodes are ordered (and accessed). Multiple choices:</p><ul><li><p>"<code>random</code>": Children are ordered randomly.</p></li>
<li><p>"<code>first_valid_node</code>": Initial order is preserved.</p></li>
<li><p>"<code>distance</code>": Nodes are ordered by increasing inter-cluster distance.</p></li>
</ul></dd>


<dt>regionalisation</dt>
<dd><p>regionalisation to start the tree traversal.</p></dd>


<dt>linkage</dt>
<dd><p>used when <code>chilChoice = </code> <code>"distance"</code>. Can
be a function or a string. This determines the linkage criterion and
so the selection of the children nodes.
If using custom  distance function, it must take the pairwise distance
matrix as an argument and return the linkage distance. Default implemented
linkages can be seen with <code><a href="available_linkages.html">available_linkages()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The triplet
(<code>search</code> = "<code>DFS</code>", <code>childChoice</code> = "<code>distance</code>",
<code>stopCriterion</code> = "<code>first_valid_branch</code>")
corresponds to an Agglomerative Hierarchical Clustering (AHC) with
contiguity and size constraints, not necessarily stopping at the fusion of
two clusters but when a feasible partition is found.
The two methods are equivalent when there is no minimum size constraint.
<a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>AHR_fusion_tree()</code>: Shortcut for <code>search_fusion_tree</code>
in the case of an AHC / AHR search.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="AHR.html">AHR()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tangi Tassin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

