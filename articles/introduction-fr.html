<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="c3t">
<title>Introduction à c3t • c3t</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction à c3t">
<meta property="og:description" content="c3t">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">c3t</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction-fr.html">Introduction à c3t</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atero18/c3t/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction à c3t</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atero18/c3t/blob/HEAD/vignettes/introduction-fr.Rmd" class="external-link"><code>vignettes/introduction-fr.Rmd</code></a></small>
      <div class="d-none name"><code>introduction-fr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atero18/c3t/" class="external-link">c3t</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>L’objectif de ce tutoriel est d’introduire quelques unes des
principales fonctions du packages <code>c3t</code>.</p>
<p>Commençons par créer une grille factice de taille 4L par 5 qui
servira d’exemple pour l’utilisation des différentes fonctions. On peut
via la fonction <code>grid_simulation</code> choisir le nombre
d’individus présents sur la grille, si certaines cases doivent être
vides et si certaines doivent être plus peuplées que les autres (être
des métropoles).</p>
<p>Un contexte sera généra pour chaque individu. Le nombre de variables
quantatitatives et qualitatives peut être choisi. Ici on choisit de
prendre 2 variables normales centrées réduites.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">4L</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">nbIndividuals</span> <span class="op">&lt;-</span> <span class="fl">100L</span></span>
<span><span class="va">nbCasesVides</span> <span class="op">&lt;-</span> <span class="fl">3L</span></span>
<span><span class="va">nbMetropolises</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="va">nbVariablesQuant</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="va">grille</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grid_simulation.html">grid_simulation</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, nbIndividuals <span class="op">=</span> <span class="va">nbIndividuals</span>,</span>
<span>                          nbMinEmptyZones <span class="op">=</span> <span class="va">nbCasesVides</span>,</span>
<span>                          nbMetropolises <span class="op">=</span> <span class="va">nbMetropolises</span>,</span>
<span>                          nbQuantitatives <span class="op">=</span> <span class="va">nbVariablesQuant</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">grille</span><span class="op">$</span><span class="va">context</span></span>
<span><span class="va">individus</span> <span class="op">&lt;-</span> <span class="va">grille</span><span class="op">$</span><span class="va">repartition</span><span class="op">$</span><span class="va">nbIndividuals</span></span>
<span><span class="va">contiguite</span> <span class="op">&lt;-</span> <span class="va">grille</span><span class="op">$</span><span class="va">contiguity</span></span></code></pre></div>
<div class="section level2">
<h2 id="régionalisation-ascendante-hiérarchique-rah">Régionalisation Ascendante Hiérarchique (RAH)<a class="anchor" aria-label="anchor" href="#r%C3%A9gionalisation-ascendante-hi%C3%A9rarchique-rah"></a>
</h2>
<p>Dans l’optique de trouver une solution faisable à un problème de
régionalisation avec éventuelle contrainte de taille min / et ou max, la
fonction <code>AHR</code> peut être utilisée. Celle-ci permet
d’appliquer un algorithme de Classification Ascendante Hiérarchique
modifié afin de respecter les contraintes de contiguïté et taille
maximale. Cette fonction va appliquer une ou plusieurs itérations de CAH
en fonction des paramétrisations données par l’utilisateur.</p>
<p>Plusieurs paramètres sont disponibles. Pour plus de détails voir
<code><a href="../reference/AHR.html">help("AHR")</a></code>. Comme pour la CAH classique la fonction prend
une distance de liaison (<em>linkage</em>). Plusieurs distances sont
déjà implémentées dans le <em>package</em>, et sont visibles via l’appel
suivant :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_linkages.html">available_linkages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Single"    "Complete"  "Centroid"  "Average"   "Medoid"    "Hausdorff"</span></span></code></pre></div>
<p>Une distance de liaison peut également être proposée par
l’utilisateur sous la forme d’une fonction prenant en argument une
matrice de distances entre les éléments d’un premier cluster et les
éléments d’un autre.</p>
<p>Plusieurs distances de liaison peut être indiquées.</p>
<div class="section level3">
<h3 id="contrainte-de-fusion">Contrainte de fusion<a class="anchor" aria-label="anchor" href="#contrainte-de-fusion"></a>
</h3>
<p>Lorsqu’il y a une contrainte de taille min, l’algorithme n’assure pas
que celle-ci sera vérifiée contrairement aux autres contraintes. Des
paramètres permettent de perturber le parcours de l’arbre afin de
faciliter la vérification.</p>
<p><code>fusionConstraint</code> indique s’il faut appliquer une
contrainte sur le choix de la fusion et si oui laquelle. Les
possibilités implémentées sont les suivantes :</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_fusion_constraints.html">available_fusion_constraints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA             "singletonMin" "singletonAny" "minMin"       "sizePenalty"</span></span></code></pre></div>
<p><code>NA</code> signifiant qu’aucune contrainte n’est ajoutée.</p>
<p><code>fusionConstraintMode</code> définit comment la contrainte de
fusion (si elle existe) doit être appliquée.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_fusion_constraints.html">available_fusion_modes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "deterministic" "random"</span></span></code></pre></div>
<p>Plusieurs contraintes et modes de fusions peuvent être demandés.</p>
</div>
<div class="section level3">
<h3 id="situation-initiale">Situation initiale<a class="anchor" aria-label="anchor" href="#situation-initiale"></a>
</h3>
<p>Plutôt que de démarrer du bas de l’arbre, c’est-à-dire de la
partition triviale (1 élément = 1 cluster), il est possible de démarrer
de plus profond et peut-être d’obtenir de meilleur résultat d’un point
de vue global ou du point de vue du respect de l’éventuelle contrainte
de taille minimale.</p>
<p>L’utilisateur peut choisir s’il souhaite ne démarrer que du bas de
l’arbre (de manière classique) ou également essayer de démarrer à partir
d’une ou plusieurs partitions initiales générées aléatoirement. C’est ce
que permet le paramètre <code>nbTries</code>, indiquant le nombre de
situations initiales à tester, dont la
classique.<code>propFusionsInit</code> indique à quel point les
partitions obtenues aléatoirement doivent être récupérées profondément
dans l’arbre.</p>
</div>
<div class="section level3">
<h3 id="critères">Critères<a class="anchor" aria-label="anchor" href="#crit%C3%A8res"></a>
</h3>
<p>Un ou plusieurs critères de classification peuvent être calculés sur
les différentes solutions faisables, si elles existent. Plusieurs
critères sont disponibles :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_criteria.html">available_criteria</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CHI"        "Dunn"       "Silhouette"</span></span></code></pre></div>
<p>Le critère du score de silhouette n’est disponible que si le package
<code>cluster</code> est installé.</p>
<p>Pour cet exemple nous choisissons le critère “CHI”, c’est-à-dire
l’indice de Calinski-Harabasz. Celui-ci nécessite qu’un contexte soit
donné et que toutes ses variables soient quantitatives.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">critere</span> <span class="op">&lt;-</span> <span class="st">"CHI"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h3>
<p>Appliquons l’algorithme sur nous données. Pour cet exemple nous
fixons deux contraintes de taille non-triviale (i.e. qui ne sont pas
systématiquement vérifiées) et utilisons la distance euclidienne.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">5.0</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">40.0</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="st">"euclidean"</span></span></code></pre></div>
<p>L’algorithme utilise de l’aléatoire pour la génération de partitions
initiales et éventuellement l’application de contraintes de fusion. Nous
fixons donc préalablement une graine aléatoire.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="va">resRAH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AHR.html">AHR</a></span><span class="op">(</span>contiguity <span class="op">=</span> <span class="va">contiguite</span>,</span>
<span>              d <span class="op">=</span> <span class="va">d</span>, data <span class="op">=</span> <span class="va">data</span>,</span>
<span>              sizes <span class="op">=</span> <span class="va">individus</span>,</span>
<span>              m <span class="op">=</span> <span class="va">m</span>, M <span class="op">=</span> <span class="va">M</span>,</span>
<span>              criteria <span class="op">=</span> <span class="va">critere</span>,</span>
<span>              fusionConstraints <span class="op">=</span> <span class="fu"><a href="../reference/available_fusion_constraints.html">available_fusion_constraints</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              fusionConstraintModes <span class="op">=</span> <span class="fu"><a href="../reference/available_fusion_constraints.html">available_fusion_modes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              parallele <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting time: 2023-09-04 10:32:20.204644</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> 45 AHC to evaluate</span></span>
<span><span class="co">#&gt; → 432 non-trivial regionalisations obtained</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 56 feasable partitions obtained</span></span>
<span><span class="co">#&gt; → 18 redundancies have been removed.</span></span>
<span><span class="co">#&gt; → Calculation of the CHI criterion</span></span>
<span><span class="co">#&gt; → Execution time: 4.95028042793274</span></span></code></pre></div>
<p>La fonction renvoie une liste de 3 <code>tibble</code>. Les solutions
faisables sont contenues dans <code>results</code> :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resRAH</span><span class="op">$</span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">nbClusters</span>, <span class="va">partition</span>, <span class="va">CHI</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   nbClusters partition      CHI</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          3 <span style="color: #949494;">&lt;int [20]&gt;</span>    2.39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>          4 <span style="color: #949494;">&lt;int [20]&gt;</span>    2.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>          4 <span style="color: #949494;">&lt;int [20]&gt;</span>    2.27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>          3 <span style="color: #949494;">&lt;int [20]&gt;</span>    2.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>          3 <span style="color: #949494;">&lt;int [20]&gt;</span>    2.04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>          5 <span style="color: #949494;">&lt;int [20]&gt;</span>    1.95</span></span></code></pre></div>
<p>38 solutions faisables distinctes ont été obtenues.</p>
<p>La solution en elle-même se trouve dans la colonne
<code>partition</code>. Voici la solution faisable qui offre le meilleur
indice de Calinski-Harabasz parmi celles trouvées :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regionalisation</span> <span class="op">&lt;-</span> <span class="va">resRAH</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">partition</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">regionalisation</span></span>
<span><span class="co">#&gt;  [1] 1 2 2 1 1 1 3 1 3 3 1 3 1 1 1 3 1 1 1 3</span></span></code></pre></div>
<p>Celle-ci vérifie bien les contraintes de contiguïté et de taille
:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_solution.html">is_feasible_solution</a></span><span class="op">(</span><span class="va">regionalisation</span>, <span class="va">contiguite</span>,</span>
<span>                     <span class="va">individus</span>, <span class="va">m</span>, <span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="amélioration-de-la-solution-faisable">Amélioration de la solution faisable<a class="anchor" aria-label="anchor" href="#am%C3%A9lioration-de-la-solution-faisable"></a>
</h2>
<p>Une solution faisable ayant été obtenue, on souhaite l’améliorer au
regard d’un certain critère tout en préservant les contraintes. C’est ce
que permet de faire la fonction <code>enhance_feasible</code>.</p>
<p>En conservant notre critère précédent (Calinski-Harabasz), on regarde
si celui-ci peut être amélioré. On regarde également si le critère
d’optimisation locale (“AHC”) permet d’améliorer l’ICH. Le critère “AHC”
nécessite une distance de liaison. On propose d’utiliser les distances
de saut minimal et maximal.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">criteresAmelioration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AHC"</span>, <span class="st">"CHI"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="va">resEnhance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/enhance_feasible.html">enhance_feasible</a></span><span class="op">(</span><span class="va">regionalisation</span>,</span>
<span>                               contiguity <span class="op">=</span> <span class="va">contiguite</span>,</span>
<span>                               d <span class="op">=</span> <span class="va">d</span>, data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                               sizes <span class="op">=</span> <span class="va">individus</span>,</span>
<span>                               m <span class="op">=</span> <span class="va">m</span>, M <span class="op">=</span> <span class="va">M</span>,</span>
<span>                               enhanceCriteria <span class="op">=</span> <span class="va">criteresAmelioration</span>,</span>
<span>                               linkages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"single"</span>, <span class="st">"complete"</span><span class="op">)</span>,</span>
<span>                               parallele <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                               verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Evaluation of the 3 enhancements</span></span>
<span><span class="co">#&gt; → Calculation of 1 evaluation criteria on the initial partition</span></span>
<span><span class="co">#&gt; → Calcul of 1 evaluation criteria on the 3 enhanced partitions</span></span>
<span></span>
<span><span class="va">resEnhance</span><span class="op">$</span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">tempsCalcul_mins</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   criterion linkage  statut       iterations regionalisationOpti dt_CHI</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AHC       Single   amelioration          1 <span style="color: #949494;">&lt;int [20]&gt;</span>          -<span style="color: #BB0000;">0.258</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AHC       Complete amelioration          6 <span style="color: #949494;">&lt;int [20]&gt;</span>          -<span style="color: #BB0000;">1.61</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> CHI       <span style="color: #BB0000;">NA</span>       amelioration          1 <span style="color: #949494;">&lt;int [20]&gt;</span>           0.117</span></span></code></pre></div>
<p>L’optimisation sous l’ICH permet d’augmenter cet indice de 0,1 , soit
une amélioration d’environ 4L%. La solution proposée est bien une
solution faisable :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partitionCHI</span> <span class="op">&lt;-</span> <span class="va">resEnhance</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">regionalisationOpti</span><span class="op">[[</span><span class="fl">3L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/check_solution.html">is_feasible_solution</a></span><span class="op">(</span><span class="va">partitionCHI</span>,</span>
<span>                     <span class="va">contiguite</span>,</span>
<span>                     <span class="va">individus</span>, <span class="va">m</span>, <span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="régularisation">Régularisation<a class="anchor" aria-label="anchor" href="#r%C3%A9gularisation"></a>
</h2>
<p>Supposons que l’algorithme <code>AHR</code> n’ait pas pu fournir une
solution faisable (ce qui ne peut être le cas que s’il y a une
contrainte de taille minimale). La fonction
<code>resolve_unfeasible</code> va essayer de fournir une solution
faisable à partir d’une solution qui vérifie la contrainte de contiguïté
mais pas forcément les contraintes de taille.</p>
<p>Prenons par exemple la partition suivante :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regInfaisable</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">4L</span>,</span>
<span>    <span class="fl">4L</span>, <span class="fl">2L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span></span></code></pre></div>
<p>Celle-ci est composée de 4L clusters. On peut vérifier que tous ses
clusters sont bien des régions, mais qu’elle ne vérifie pas les
contraintes de tailles fixées précédemment. Le premier cluster est trop
petit et le quatrième trop grand.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_solution.html">is_regionalisation</a></span><span class="op">(</span><span class="va">regInfaisable</span>, <span class="va">contiguite</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/clusters_sizes.html">clusters_sizes</a></span><span class="op">(</span><span class="va">regInfaisable</span>, <span class="va">individus</span><span class="op">)</span></span>
<span><span class="co">#&gt;  1  2  3  4 </span></span>
<span><span class="co">#&gt;  3 31 23 43</span></span></code></pre></div>
<p><code>resolve_unfeasible</code> va à partir de de régionalisation
proposer une solution faisable, en augmentant la taille du premier
cluster et en baissant la taille du dernier.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="va">resolution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resolve_unfeasible.html">resolve_unfeasible</a></span><span class="op">(</span>contiguity <span class="op">=</span> <span class="va">contiguite</span>, sizes <span class="op">=</span> <span class="va">individus</span>,</span>
<span>                                 data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                                 d <span class="op">=</span> <span class="va">d</span>, m <span class="op">=</span> <span class="va">m</span>, M <span class="op">=</span> <span class="va">M</span>,</span>
<span>                                 regionalisation <span class="op">=</span> <span class="va">regInfaisable</span>,</span>
<span>                                 verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Transfert of elements one-by-one</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> fully resolved partition</span></span>
<span></span>
<span><span class="va">resolution</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] "fully_resolved"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $itTransfers</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $itFusions</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $initialSmallRegions</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $finalSmallRegions</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $initialBigRegions</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $finalBigRegions</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $resolvedRegions</span></span>
<span><span class="co">#&gt; [1] 1 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $initialRegionsSizes</span></span>
<span><span class="co">#&gt;  1  2  3  4 </span></span>
<span><span class="co">#&gt;  3 31 23 43 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $finalRegionsSizes</span></span>
<span><span class="co">#&gt;  1  2  3  4 </span></span>
<span><span class="co">#&gt;  7 35 23 35 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $regionalisation</span></span>
<span><span class="co">#&gt;  [1] 1 1 2 3 3 3 3 3 3 4 4 3 4 3 3 4 4 3 3 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $initialNbClusters</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $finalNbClusters</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<p>La fonction a obtenu une solution faisable en réalisant six
transferts d’éléments. Tous les contraintes sont désormais respectées.
En particulier, la solution est bien une régionalisation :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_solution.html">is_regionalisation</a></span><span class="op">(</span><span class="va">resolution</span><span class="op">$</span><span class="va">regionalisation</span>, <span class="va">contiguite</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tangi Tassin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
